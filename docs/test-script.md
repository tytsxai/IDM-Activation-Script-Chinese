# 测试脚本.cmd 检查项与退出码设计

- 退出码为所有失败项的位或结果，可用于自动化解析；成功时为 `0`。
- 检查输出沿用 `[√]/[×]`，失败时直接返回退出码（无 `pause`）。

## 检查项与位值

| 检查 | 失败时退出码位值 | 说明 |
| --- | --- | --- |
| 管理员权限（fltmc） | 1 | 需要以管理员身份运行 |
| PowerShell 是否存在 | 2 | 未找到 powershell.exe |
| PowerShell 语言模式 | 4 | 不是 FullLanguage 或无法读取 |
| Null 服务 | 8 | 服务未运行，批处理可能异常 |
| 网络到 internetdownloadmanager.com | 16 | 无法 ping 且端口 80 不通 |
| 代码页 | 32 | 非 936，建议手动 `chcp 936` |
| IAS.cmd 是否同目录 | 64 | 未检测到 IAS.cmd |
| WMI 可用性 | 128 | wmic 与 PowerShell 都无法访问 WMI |
| IDM 安装路径 | 256 | 注册表缺失或路径内无 IDMan.exe |
| 脚本目录写权限 | 512 | 当前位置不可写，需移出受限目录 |

> 最终退出码 = 所有失败项位值之和，例如 129 表示管理员未开启且 WMI 不可用。
