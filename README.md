# IDM 激活脚本 v1.2

> 🚀 一键激活 Internet Download Manager (IDM) 下载管理器

## 📋 目录

- [功能特性](#功能特性)
- [系统要求](#系统要求)
- [使用方法](#使用方法)
- [功能说明](#功能说明)
- [常见问题](#常见问题)
- [技术细节](#技术细节)
- [更新日志](#更新日志)

## ✨ 功能特性

- ✅ **支持最新版本** - 兼容所有 IDM 版本
- ✅ **三种激活模式** - 冻结激活、普通激活、重置功能
- ✅ **完美中文支持** - 修复所有乱码问题
- ✅ **自动备份** - 安全备份注册表，随时可恢复
- ✅ **智能检测** - 自动检测系统环境和 IDM 状态
- ✅ **无需破解** - 不修改 IDM 程序文件

## 💻 系统要求

| 项目 | 要求 |
|------|------|
| 操作系统 | Windows 7/8/8.1/10/11 |
| 权限 | 管理员权限 |
| 依赖 | PowerShell (系统自带) |
| 网络 | 需访问 internetdownloadmanager.com |

## 🚀 使用方法

### 方法一：图形界面（推荐新手）

1. **右键点击** `IAS.cmd` 或 `快速激活.cmd`
2. **选择** "以管理员身份运行"
3. **按照菜单提示操作**

```
┌─────────────────────────────────────┐
│   IDM 激活脚本主菜单                │
├─────────────────────────────────────┤
│  [1] 激活（冻结）  ⭐ 推荐          │
│  [2] 激活                            │
│  [3] 重置激活/试用期                │
│  [4] 下载 IDM                        │
│  [5] 帮助                            │
│  [0] 退出                            │
└─────────────────────────────────────┘
```

### 方法二：命令行（推荐高级用户）

以管理员身份打开 CMD，然后运行：

```cmd
# 冻结激活（推荐）
IAS.cmd /frz

# 普通激活
IAS.cmd /act

# 重置激活
IAS.cmd /res
```

## 📖 功能说明

### 🌟 激活（冻结）[推荐]

- **功能**：将 IDM 的 30 天试用期永久冻结
- **优点**：不会触发假阳性警告，最稳定
- **适用**：所有用户推荐使用

### ⚡ 激活

- **功能**：使用随机生成的注册信息激活 IDM
- **注意**：部分用户可能看到"假阳性序列号"警告
- **建议**：如遇警告，改用"激活（冻结）"

### 🔄 重置激活/试用期

- **功能**：清除所有激活信息，恢复初始状态
- **用途**：解决激活异常、更换激活方式

## ❓ 常见问题

<details>
<summary><b>Q1: 提示"需要管理员权限"怎么办？</b></summary>

**解决方法：**
- 右键脚本文件
- 选择"以管理员身份运行"
- 不要直接双击运行

</details>

<details>
<summary><b>Q2: 提示"IDM 未安装"？</b></summary>

**解决方法：**
1. 先安装 IDM
2. 官方下载：https://www.internetdownloadmanager.com/download.html
3. 安装完成后再运行激活脚本

</details>

<details>
<summary><b>Q3: 激活后仍提示注册？</b></summary>

**解决方法：**
1. 使用"激活（冻结）"选项
2. 或先执行"重置激活"，再重新激活
3. 完全卸载 IDM 后重新安装

</details>

<details>
<summary><b>Q4: 中文显示为乱码？</b></summary>

**解决方法：**
1. 本版本已修复所有乱码问题
2. 如仍有问题，在 CMD 中运行：`chcp 936`
3. 确保系统区域设置为中国或简体中文

</details>

<details>
<summary><b>Q5: 提示"无法连接到 internetdownloadmanager.com"？</b></summary>

**解决方法：**
1. 检查网络连接
2. 关闭 VPN 或代理
3. 配置系统代理设置
4. 临时关闭防火墙测试

</details>

<details>
<summary><b>Q6: PowerShell 被组织策略禁用？</b></summary>

**解决方法：**
1. 联系 IT 管理员
2. 查看帮助文档：https://massgrave.dev/idm-activation-script.html#Troubleshoot
3. 使用个人电脑尝试

</details>

## 🔧 技术细节

### 工作原理

1. **锁定/删除** CLSID 注册表键
2. **注入随机** 注册信息（激活模式）
3. **下载测试** 文件验证 IDM 功能
4. **冻结试用期**（冻结模式）

### 注册表备份

脚本会自动备份注册表到以下位置：

```
C:\Windows\Temp\_Backup_HKCU_CLSID_[时间戳].reg
C:\Windows\Temp\_Backup_HKU-[SID]_CLSID_[时间戳].reg
```

**恢复方法：** 双击 `.reg` 文件即可导入恢复

### 安全性

- ✅ 不修改 IDM 程序文件
- ✅ 仅修改注册表配置
- ✅ 自动备份，可随时恢复
- ✅ 开源透明，代码可审查

## 📦 文件说明

| 文件名 | 说明 |
|--------|------|
| `IAS.cmd` | 主激活脚本 |
| `快速激活.cmd` | 快捷启动工具 |
| `测试脚本.cmd` | 系统环境检测 |
| `使用说明.txt` | 详细使用说明 |
| `README.md` | 本说明文档 |

## 📝 更新日志

### v1.2 (当前版本) - 2024-10-05

#### 🎉 新增功能
- ✨ 完美修复所有中文显示乱码问题
- ✨ 添加快速激活启动器
- ✨ 新增系统环境检测工具
- ✨ 创建详细使用说明文档

#### 🔧 优化改进
- 🚀 在所有 `cls` 清屏命令后添加代码页恢复
- 🚀 优化用户界面，提示信息更友好
- 🚀 增强错误处理机制
- 🚀 改进注册表备份机制
- 🚀 启动时强制设置 GBK 代码页

#### 🐛 问题修复
- ✅ 修复主菜单中文正常但二级菜单乱码问题
- ✅ 修复多次清屏导致代码页重置问题
- ✅ 修复某些系统环境下的显示异常

## 🌐 相关链接

- **项目主页**: https://github.com/WindowsAddict/IDM-Activation-Script
- **文档中心**: https://massgrave.dev/idm-activation-script
- **IDM 官网**: https://www.internetdownloadmanager.com
- **问题反馈**: windowsaddict@protonmail.com

## ⚠️ 免责声明

> **本脚本仅供学习和测试使用！**

- 本工具仅用于学习 Windows 注册表操作和批处理编程
- 请支持正版软件，购买官方授权
- 长期使用建议购买正版：https://www.internetdownloadmanager.com/buy_now.html
- 作者不对使用本工具产生的任何后果负责

## 📄 许可证

本项目遵循原项目许可证。详见：https://github.com/WindowsAddict/IDM-Activation-Script

---

<div align="center">

**如果这个工具帮到了你，请给原项目一个 ⭐ Star！**

Made with ❤️ by [WindowsAddict](https://github.com/WindowsAddict)

中文优化版本 v1.2

</div>
